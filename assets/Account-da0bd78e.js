import{a7 as y,r as x,a8 as U,j as e,$ as b,a0 as o,a1 as h,a3 as F,c as j,_ as R,C as A,H as w,R as g}from"./index-7869a08a.js";import{u as k}from"./index.esm-84e5aa2a.js";function P(){const{user:{email:c,user_metadata:{fullname:u,avatar:t}}}=y(),[n,s]=x.useState(u||"Unknown"),[a,d]=x.useState(t||"default-user.jpg"),[f,l]=x.useState(""),{updateUserMutate:p,isUserUpdating:r}=U(),v=a==="default-user.jpg"?a:!a||a===t?t??"default-user.jpg":URL.createObjectURL(a),C=i=>{i.preventDefault();const m=n.trim();if(!m||m==="Unknown")return l("Please update your full name.");if(m===u&&(!a||a===t||a==="default-user.jpg"))return R.error("There are no changes. Please update your name or avatar.");p({fullname:m,avatar:a==="default-user.jpg"?null:a},{onSuccess:()=>{d(null),l(""),i.target.reset()}})},S=()=>{s(u),d(t||"default-user.jpg"),l("")};return e.jsxs(b,{onSubmit:C,children:[e.jsx(o,{label:"Email address",children:e.jsx(h,{value:c,disabled:!0})}),e.jsx(o,{label:"Username",error:f,children:e.jsx(h,{id:"fullname",type:"text",defaultValue:n||"Unknown",onChange:i=>{s(i.target.value),l("")},disabled:r})}),e.jsx(o,{label:"Avatar image",updateValues:{image:v,name:`Avatar of ${n}`},previewLoading:r,children:e.jsx(F,{id:"avatar",accept:"image/*",onChange:i=>d(i.target.files[0]),disabled:r})}),e.jsxs(o,{children:[e.jsx(j,{type:"reset",variation:"secondary",disabled:r,onClick:S,children:"Reset"}),e.jsx(j,{disabled:r,children:"Update account"})]})]})}function q(){var l,p;const{register:c,handleSubmit:u,getValues:t,reset:n,formState:{errors:s}}=k(),{updateUserMutate:a,isUserUpdating:d}=U(),f=({password:r})=>{a({password:r},{onSuccess:n()})};return e.jsxs(b,{onSubmit:u(f),children:[e.jsx(o,{label:"New password (min 8 chars)",error:(l=s==null?void 0:s.password)==null?void 0:l.message,children:e.jsx(h,{type:"password",id:"password",autoComplete:"current-password",disabled:d,...c("password",{required:"This field is required",minLength:{value:8,message:"Password needs a minimum of 8 characters"}})})}),e.jsx(o,{label:"Confirm password",error:(p=s==null?void 0:s.passwordConfirm)==null?void 0:p.message,children:e.jsx(h,{type:"password",autoComplete:"new-password",id:"passwordConfirm",disabled:d,...c("passwordConfirm",{required:"This field is required",validate:r=>t().password===r||"Passwords need to match"})})}),e.jsxs(o,{children:[e.jsx(j,{onClick:n,type:"reset",variation:"secondary",children:"Clear"}),e.jsx(j,{disabled:d,children:"Update password"})]})]})}function M(){return e.jsxs(A,{children:[e.jsx(w,{as:"h1",children:"Update your account"}),e.jsxs(g,{children:[e.jsx(w,{as:"h3",children:"Update user data"}),e.jsx(P,{})]}),e.jsxs(g,{children:[e.jsx(w,{as:"h3",children:"Update password"}),e.jsx(q,{})]})]})}export{M as default};
